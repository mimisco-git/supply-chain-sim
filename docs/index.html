<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Supply Chain Disruption Simulator ‚Äî Nigeria</title>
<script>tailwind.config={darkMode:'media',theme:{extend:{fontFamily:{serif:['DM Serif Display','Georgia','serif'],sans:['Outfit','system-ui','sans-serif'],mono:['JetBrains Mono','monospace']},colors:{ink:{DEFAULT:'#0c0c0b',50:'#f7f7f6',100:'#eeede9',200:'#dddbd4',300:'#c7c4ba',400:'#a8a49a',500:'#8a8680',600:'#6e6a64',700:'#56534e',800:'#3d3b37',900:'#26251f',950:'#151410'}},keyframes:{fadeUp:{from:{opacity:'0',transform:'translateY(12px)'},to:{opacity:'1',transform:'translateY(0)'}},flash:{from:{opacity:'.35'},to:{opacity:'1'}},pulseRed:{'0%,100%':{boxShadow:'0 0 0 0 rgba(239,68,68,0.4)'},'50%':{boxShadow:'0 0 0 6px rgba(239,68,68,0)'}}},animation:{fadeUp:'fadeUp .35s ease forwards',flash:'flash .25s ease',pulseRed:'pulseRed 2s infinite'}}}}</script>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"/>
<style>
  /* Custom range slider */
  input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:4px;border-radius:2px;outline:none;cursor:pointer;}
  input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;cursor:pointer;border:3px solid white;box-shadow:0 1px 6px rgba(0,0,0,0.25);transition:transform .15s;}
  input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.2);}
  @media(prefers-color-scheme:dark){
    input[type=range]::-webkit-slider-thumb{border-color:#18181b;}
  }
  .range-red{background:linear-gradient(90deg,#fca5a5,#ef4444);}
  .range-red::-webkit-slider-thumb{background:#ef4444;}
  .range-amber{background:linear-gradient(90deg,#fcd34d,#f59e0b);}
  .range-amber::-webkit-slider-thumb{background:#f59e0b;}
  .range-blue{background:linear-gradient(90deg,#93c5fd,#3b82f6);}
  .range-blue::-webkit-slider-thumb{background:#3b82f6;}
  .range-emerald{background:linear-gradient(90deg,#6ee7b7,#10b981);}
  .range-emerald::-webkit-slider-thumb{background:#10b981;}

  /* Scrollbar */
  ::-webkit-scrollbar{width:4px;height:4px;}
  ::-webkit-scrollbar-track{background:transparent;}
  ::-webkit-scrollbar-thumb{background:#d4d4d8;border-radius:2px;}
  @media(prefers-color-scheme:dark){::-webkit-scrollbar-thumb{background:#3f3f46;}}

  /* Sticky nav blur */
  .nav-blur{backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);}

  /* Number transition */
  .num-cell{transition:color .25s;}

  /* Company tab active indicator */
  .co-tab{position:relative;}
  .co-tab.active::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:2px;background:#ef4444;}
</style>
</head>

<body class="bg-white dark:bg-zinc-950 text-ink dark:text-zinc-100 font-sans antialiased transition-colors duration-300">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NAV ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<nav class="sticky top-0 z-50 bg-white/90 dark:bg-zinc-950/90 nav-blur border-b border-zinc-200 dark:border-zinc-800">
  <div class="max-w-screen-xl mx-auto px-6 h-14 flex items-center justify-between gap-4">
    <div class="flex items-center gap-3">
      <span class="font-serif text-lg tracking-tight">Supply Chain<em class="text-red-500 not-italic"> Disruption</em></span>
      <span class="hidden sm:block text-[10px] font-mono text-zinc-400 dark:text-zinc-600 tracking-widest uppercase">Simulator</span>
    </div>
    <div class="flex items-center gap-3">
      <span class="hidden md:block text-[10px] font-mono tracking-widest text-zinc-400 dark:text-zinc-600 uppercase">Nigeria ¬∑ Real Company Data ¬∑ 2024</span>
      <span id="nav-severity" class="text-[10px] font-mono font-semibold tracking-wider px-3 py-1.5 rounded-full bg-emerald-50 dark:bg-emerald-950 text-emerald-700 dark:text-emerald-400 border border-emerald-200 dark:border-emerald-800 transition-all duration-300">‚óè STABLE</span>
    </div>
  </div>
</nav>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="max-w-screen-xl mx-auto px-6 pt-14 pb-10">
  <p class="text-[10px] font-mono tracking-[.22em] text-red-500 uppercase mb-4 flex items-center gap-2">
    <span class="inline-block w-6 h-px bg-red-500"></span>Interactive Risk Tool
  </p>
  <h1 class="font-serif text-5xl md:text-6xl lg:text-7xl leading-[1.02] tracking-tight mb-5">
    What Does a <em class="text-red-500">Supply Chain</em><br/>Shock Cost Nigeria?
  </h1>
  <p class="text-zinc-500 dark:text-zinc-400 text-base max-w-xl leading-relaxed mb-8">
    Move the sliders to simulate real disruption scenarios ‚Äî Naira devaluation, port delays, fuel spikes, supplier failure. See exact cost impact on real Nigerian companies, instantly.
  </p>
  <!-- Stats row -->
  <div class="flex flex-wrap gap-x-10 gap-y-4">
    <div>
      <div class="font-serif text-2xl text-red-500">‚Ç¶1,590</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-400 dark:text-zinc-600 uppercase mt-0.5">USD/NGN Today</div>
    </div>
    <div>
      <div class="font-serif text-2xl text-amber-500">+282%</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-400 dark:text-zinc-600 uppercase mt-0.5">Naira Depreciation Since 2022</div>
    </div>
    <div>
      <div class="font-serif text-2xl">5 Companies</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-400 dark:text-zinc-600 uppercase mt-0.5">Modelled in Simulator</div>
    </div>
    <div>
      <div class="font-serif text-2xl text-red-500">‚Ç¶847B+</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-400 dark:text-zinc-600 uppercase mt-0.5">Estimated FX Losses 2023</div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê COMPANY TABS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="border-y border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-950 overflow-x-auto">
  <div class="max-w-screen-xl mx-auto px-6">
    <div class="flex" id="company-tabs">
      <!-- Rendered by JS -->
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN GRID ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<main class="max-w-screen-xl mx-auto px-6 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-[360px_1fr] gap-6 items-start">

    <!-- ‚îÄ‚îÄ CONTROL PANEL ‚îÄ‚îÄ -->
    <div class="sticky top-16 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm">
      <!-- Header -->
      <div class="bg-zinc-950 dark:bg-black px-6 py-5 border-b border-zinc-800">
        <h2 class="font-serif text-white text-xl">Disruption Controls</h2>
        <p class="text-zinc-500 text-[11px] font-mono mt-1">Drag sliders ¬∑ Results update instantly</p>
      </div>
      <!-- Sliders -->
      <div class="p-6 space-y-7">

        <!-- FX -->
        <div>
          <div class="flex justify-between items-center mb-1">
            <span class="text-sm font-semibold text-zinc-700 dark:text-zinc-300">üí± Naira Devaluation</span>
            <span id="val-fx" class="font-mono text-sm font-semibold text-red-500">0%</span>
          </div>
          <p class="text-[10px] font-mono text-zinc-400 dark:text-zinc-600 mb-3 leading-relaxed">How much the Naira weakens beyond today's ‚Ç¶1,590/$. Every 10% spike = higher import costs across the board.</p>
          <input type="range" id="sl-fx" class="range-red" min="0" max="80" step="5" value="0" oninput="simulate()"/>
          <div class="flex justify-between text-[9px] font-mono text-zinc-400 mt-1.5"><span>0%</span><span>20%</span><span>40%</span><span>60%</span><span>80%</span></div>
        </div>

        <!-- Fuel -->
        <div>
          <div class="flex justify-between items-center mb-1">
            <span class="text-sm font-semibold text-zinc-700 dark:text-zinc-300">‚õΩ Fuel Price Increase</span>
            <span id="val-fuel" class="font-mono text-sm font-semibold text-amber-500">0%</span>
          </div>
          <p class="text-[10px] font-mono text-zinc-400 dark:text-zinc-600 mb-3 leading-relaxed">Petrol/diesel cost spike. Hits transportation, generators, and logistics at every supply chain node.</p>
          <input type="range" id="sl-fuel" class="range-amber" min="0" max="150" step="10" value="0" oninput="simulate()"/>
          <div class="flex justify-between text-[9px] font-mono text-zinc-400 mt-1.5"><span>0%</span><span>50%</span><span>100%</span><span>150%</span></div>
        </div>

        <!-- Port -->
        <div>
          <div class="flex justify-between items-center mb-1">
            <span class="text-sm font-semibold text-zinc-700 dark:text-zinc-300">‚öì Port Clearance Delay</span>
            <span id="val-port" class="font-mono text-sm font-semibold text-blue-500">0 days</span>
          </div>
          <p class="text-[10px] font-mono text-zinc-400 dark:text-zinc-600 mb-3 leading-relaxed">Extra days beyond normal 22-day Apapa clearance. Each extra day adds demurrage and working capital costs.</p>
          <input type="range" id="sl-port" class="range-blue" min="0" max="60" step="5" value="0" oninput="simulate()"/>
          <div class="flex justify-between text-[9px] font-mono text-zinc-400 mt-1.5"><span>0d</span><span>15d</span><span>30d</span><span>45d</span><span>60d</span></div>
        </div>

        <!-- Supplier -->
        <div>
          <div class="flex justify-between items-center mb-1">
            <span class="text-sm font-semibold text-zinc-700 dark:text-zinc-300">üîó Supplier Failure Rate</span>
            <span id="val-supplier" class="font-mono text-sm font-semibold text-emerald-600 dark:text-emerald-400">0%</span>
          </div>
          <p class="text-[10px] font-mono text-zinc-400 dark:text-zinc-600 mb-3 leading-relaxed">% of key suppliers that fail to deliver. Forces emergency sourcing at 32% price premium.</p>
          <input type="range" id="sl-supplier" class="range-emerald" min="0" max="50" step="5" value="0" oninput="simulate()"/>
          <div class="flex justify-between text-[9px] font-mono text-zinc-400 mt-1.5"><span>0%</span><span>10%</span><span>25%</span><span>50%</span></div>
        </div>

        <!-- Divider -->
        <div class="border-t border-zinc-100 dark:border-zinc-800 pt-5">
          <p class="text-[9px] font-mono tracking-widest text-zinc-400 dark:text-zinc-600 uppercase mb-3">Quick Scenarios</p>
          <div class="grid grid-cols-2 gap-2">
            <button onclick="loadScenario('mild')" class="py-2.5 px-3 text-[10px] font-mono font-semibold tracking-wider rounded-lg border border-emerald-300 dark:border-emerald-800 text-emerald-700 dark:text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-950 transition-colors">2023 MILD</button>
            <button onclick="loadScenario('moderate')" class="py-2.5 px-3 text-[10px] font-mono font-semibold tracking-wider rounded-lg border border-amber-300 dark:border-amber-800 text-amber-700 dark:text-amber-500 hover:bg-amber-50 dark:hover:bg-amber-950 transition-colors">2024 REALITY</button>
            <button onclick="loadScenario('severe')" class="py-2.5 px-3 text-[10px] font-mono font-semibold tracking-wider rounded-lg border border-red-300 dark:border-red-900 text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-950 transition-colors">SEVERE SHOCK</button>
            <button onclick="loadScenario('crisis')" class="py-2.5 px-3 text-[10px] font-mono font-semibold tracking-wider rounded-lg bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 hover:bg-zinc-800 dark:hover:bg-zinc-200 transition-colors">FULL CRISIS</button>
          </div>
          <button onclick="resetAll()" class="w-full mt-2.5 py-2.5 text-[10px] font-mono font-semibold tracking-widest uppercase text-zinc-400 dark:text-zinc-600 border border-zinc-200 dark:border-zinc-800 rounded-lg hover:border-zinc-300 dark:hover:border-zinc-700 hover:text-zinc-600 dark:hover:text-zinc-400 transition-colors">‚Ü∫ Reset to Baseline</button>
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ RESULTS ‚îÄ‚îÄ -->
    <div class="space-y-5">

      <!-- TOTAL IMPACT CARD -->
      <div class="rounded-2xl overflow-hidden border border-zinc-200 dark:border-zinc-800 shadow-sm">
        <!-- Big number header -->
        <div class="bg-zinc-950 dark:bg-black p-7 relative overflow-hidden">
          <div class="absolute -top-12 -right-12 w-48 h-48 rounded-full bg-red-500/5 pointer-events-none"></div>
          <div class="absolute -bottom-8 -left-8 w-32 h-32 rounded-full bg-amber-500/5 pointer-events-none"></div>
          <div class="relative">
            <p class="text-[9px] font-mono tracking-[.2em] text-zinc-600 uppercase mb-2" id="ih-company">Dangote Cement ¬∑ Manufacturing</p>
            <p class="text-[11px] font-mono text-zinc-500 mb-1">Annual Additional Cost Impact</p>
            <div id="ih-total" class="font-serif text-5xl md:text-6xl text-white leading-none mb-2 transition-all duration-300">‚Ç¶0</div>
            <p class="text-xs text-zinc-500 font-mono" id="ih-sub">No disruption ‚Äî baseline normal operations</p>
          </div>
          <!-- Mini stats -->
          <div class="grid grid-cols-4 gap-0 mt-6 pt-5 border-t border-zinc-800">
            <div class="text-center px-3 border-r border-zinc-800">
              <div id="cell-fx" class="font-mono text-sm font-semibold text-red-400">+‚Ç¶0</div>
              <div class="text-[9px] font-mono text-zinc-600 mt-1 tracking-wider uppercase">FX Impact</div>
            </div>
            <div class="text-center px-3 border-r border-zinc-800">
              <div id="cell-fuel" class="font-mono text-sm font-semibold text-amber-400">+‚Ç¶0</div>
              <div class="text-[9px] font-mono text-zinc-600 mt-1 tracking-wider uppercase">Fuel Cost</div>
            </div>
            <div class="text-center px-3 border-r border-zinc-800">
              <div id="cell-port" class="font-mono text-sm font-semibold text-blue-400">+‚Ç¶0</div>
              <div class="text-[9px] font-mono text-zinc-600 mt-1 tracking-wider uppercase">Port Delay</div>
            </div>
            <div class="text-center px-3">
              <div id="cell-supplier" class="font-mono text-sm font-semibold text-emerald-400">+‚Ç¶0</div>
              <div class="text-[9px] font-mono text-zinc-600 mt-1 tracking-wider uppercase">Emergency</div>
            </div>
          </div>
        </div>
        <!-- Severity bar -->
        <div id="severity-bar" class="h-1 bg-emerald-500 transition-all duration-500" style="width:2%"></div>
      </div>

      <!-- COST BREAKDOWN -->
      <div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm">
        <div class="px-6 py-4 border-b border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900 flex justify-between items-center">
          <span class="text-[10px] font-mono font-semibold tracking-widest text-zinc-500 dark:text-zinc-500 uppercase">Cost Line Breakdown</span>
          <span id="rate-label" class="text-[10px] font-mono text-zinc-400">Baseline ‚Üí Simulated</span>
        </div>
        <div class="divide-y divide-zinc-50 dark:divide-zinc-800/60" id="cost-rows"></div>
      </div>

      <!-- CHARTS -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
        <div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-5 shadow-sm">
          <p class="text-[9px] font-mono tracking-widest text-zinc-400 uppercase mb-1">Before vs After</p>
          <p class="text-sm font-semibold text-zinc-800 dark:text-zinc-200 mb-4">Cost Structure Impact</p>
          <div class="h-48 relative"><canvas id="barChart"></canvas></div>
        </div>
        <div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-5 shadow-sm">
          <p class="text-[9px] font-mono tracking-widest text-zinc-400 uppercase mb-1">FX Devaluation Curve</p>
          <p class="text-sm font-semibold text-zinc-800 dark:text-zinc-200 mb-4">Total Cost at Each Naira Level</p>
          <div class="h-48 relative"><canvas id="fxCurve"></canvas></div>
        </div>
      </div>

      <!-- RECOMMENDATIONS -->
      <div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm">
        <div class="px-6 py-4 border-b border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900">
          <span class="text-[10px] font-mono font-semibold tracking-widest text-zinc-500 uppercase">Procurement Risk Recommendations</span>
        </div>
        <div class="p-5 space-y-3" id="recommendations"></div>
      </div>

      <!-- SCENARIO TABLE -->
      <div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm">
        <div class="px-6 py-4 border-b border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900">
          <span class="text-[10px] font-mono font-semibold tracking-widest text-zinc-500 uppercase">Scenario Comparison</span>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-sm" id="scenario-table">
            <thead>
              <tr class="bg-zinc-50 dark:bg-zinc-900 border-b border-zinc-100 dark:border-zinc-800">
                <th class="text-left px-4 py-3 text-[9px] font-mono tracking-widest text-zinc-400 uppercase">Scenario</th>
                <th class="text-left px-4 py-3 text-[9px] font-mono tracking-widest text-zinc-400 uppercase">FX Rate</th>
                <th class="text-left px-4 py-3 text-[9px] font-mono tracking-widest text-zinc-400 uppercase">Fuel +%</th>
                <th class="text-left px-4 py-3 text-[9px] font-mono tracking-widest text-zinc-400 uppercase">Port Delay</th>
                <th class="text-left px-4 py-3 text-[9px] font-mono tracking-widest text-zinc-400 uppercase">Supplier Risk</th>
                <th class="text-left px-4 py-3 text-[9px] font-mono tracking-widest text-zinc-400 uppercase">Extra Annual Cost</th>
                <th class="text-left px-4 py-3 text-[9px] font-mono tracking-widest text-zinc-400 uppercase">Severity</th>
              </tr>
            </thead>
            <tbody id="scenario-tbody" class="divide-y divide-zinc-50 dark:divide-zinc-800"></tbody>
          </table>
        </div>
      </div>

    </div><!-- /results -->
  </div><!-- /grid -->
</main>

<!-- FOOTER -->
<footer class="border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-zinc-950 mt-10">
  <div class="max-w-screen-xl mx-auto px-6 py-7 flex flex-wrap justify-between items-center gap-4">
    <p class="text-[11px] font-mono text-zinc-400"><strong class="text-zinc-600 dark:text-zinc-300">Miracle Ugokwe</strong> ¬∑ Procurement Manager & Data Analyst ¬∑ MSc Procurement Management, FUTO</p>
    <p class="text-[10px] font-mono text-zinc-300 dark:text-zinc-700">CBN FX Archive ¬∑ NPA Port Statistics ¬∑ NNPC Price History ¬∑ Company Annual Reports 2023/2024</p>
  </div>
</footer>

<script>
// ‚îÄ‚îÄ DETECT DARK MODE ‚îÄ‚îÄ
const isDark = () => window.matchMedia('(prefers-color-scheme: dark)').matches;
Chart.defaults.color = isDark() ? '#71717a' : '#a1a1aa';

// ‚îÄ‚îÄ COMPANIES ‚îÄ‚îÄ
const COMPANIES = [
  { name:'Dangote Cement', sector:'Manufacturing', icon:'üè≠',
    baseRevenue:2100000000000, importRatio:.42, fuelRatio:.18, logisticsRatio:.12,
    baseCost:1200000000000, shipments:240, avgShipmentValue:850000000,
    desc:'Nigeria\'s largest cement manufacturer. Imports clinker, gypsum, and spare parts. Heavy fuel dependency for kiln operations.' },
  { name:'Jumia Nigeria', sector:'E-Commerce', icon:'üì¶',
    baseRevenue:180000000000, importRatio:.65, fuelRatio:.22, logisticsRatio:.28,
    baseCost:210000000000, shipments:1200, avgShipmentValue:45000000,
    desc:'Nigeria\'s largest e-commerce platform. Sources 65% of inventory from China and UAE. Last-mile delivery is fuel-intensive.' },
  { name:'NNPC Retail', sector:'Energy', icon:'üõ¢Ô∏è',
    baseRevenue:8500000000000, importRatio:.78, fuelRatio:.08, logisticsRatio:.09,
    baseCost:7200000000000, shipments:420, avgShipmentValue:4200000000,
    desc:'State petroleum company. USD-denominated purchase contracts make it extremely FX-sensitive.' },
  { name:'Nigerian Breweries', sector:'FMCG', icon:'üç∫',
    baseRevenue:680000000000, importRatio:.38, fuelRatio:.14, logisticsRatio:.16,
    baseCost:490000000000, shipments:180, avgShipmentValue:320000000,
    desc:'Nigeria\'s leading brewery (Heineken subsidiary). Imports barley, hops, packaging. Distribution spans 36 states.' },
  { name:'GIG Logistics', sector:'Logistics', icon:'üöö',
    baseRevenue:95000000000, importRatio:.28, fuelRatio:.38, logisticsRatio:.44,
    baseCost:78000000000, shipments:60, avgShipmentValue:180000000,
    desc:'Nigeria\'s largest indigenous logistics company. Fuel is the #1 cost driver. All vehicle parts are imported.' },
];

let currentCompany = 0;
let barChart = null, fxChart = null;

function fmt(n) {
  if(Math.abs(n)>=1e12) return '‚Ç¶'+(n/1e12).toFixed(2)+'T';
  if(Math.abs(n)>=1e9)  return '‚Ç¶'+(n/1e9).toFixed(1)+'B';
  if(Math.abs(n)>=1e6)  return '‚Ç¶'+(n/1e6).toFixed(1)+'M';
  return '‚Ç¶'+Math.round(n).toLocaleString();
}

function severityConfig(pct) {
  if(pct<=0.01) return {label:'STABLE',  tw:'bg-emerald-50 dark:bg-emerald-950 text-emerald-700 dark:text-emerald-400 border-emerald-200 dark:border-emerald-800', barColor:'#10b981', barW:'2%',  tableColor:'#10b981'};
  if(pct<=0.08) return {label:'MILD',    tw:'bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-800',       barColor:'#3b82f6', barW:'20%', tableColor:'#3b82f6'};
  if(pct<=0.18) return {label:'MODERATE',tw:'bg-amber-50 dark:bg-amber-950 text-amber-700 dark:text-amber-400 border-amber-200 dark:border-amber-800', barColor:'#f59e0b', barW:'50%', tableColor:'#f59e0b'};
  if(pct<=0.35) return {label:'SEVERE',  tw:'bg-red-50 dark:bg-red-950 text-red-700 dark:text-red-400 border-red-200 dark:border-red-900',             barColor:'#ef4444', barW:'75%', tableColor:'#ef4444'};
  return              {label:'CRISIS',   tw:'bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 border-zinc-700 dark:border-zinc-200',           barColor:'#dc2626', barW:'100%',tableColor:'#b91c1c'};
}

// ‚îÄ‚îÄ RENDER COMPANY TABS ‚îÄ‚îÄ
function renderTabs() {
  const c = document.getElementById('company-tabs');
  c.innerHTML = COMPANIES.map((co, i) => `
    <button onclick="selectCompany(${i})" class="co-tab ${i===0?'active':''} flex items-center gap-2.5 px-5 py-4 text-sm font-medium border-b-2 ${i===0?'border-red-500 text-zinc-900 dark:text-white':'border-transparent text-zinc-500 dark:text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300'} whitespace-nowrap transition-all" id="tab-${i}">
      <span class="text-lg">${co.icon}</span>
      <span>
        <span class="block font-semibold">${co.name}</span>
        <span class="block text-[10px] font-mono text-zinc-400">${co.sector}</span>
      </span>
    </button>`).join('');
}

function selectCompany(i) {
  currentCompany = i;
  document.querySelectorAll('.co-tab').forEach((t,j) => {
    if(j===i){
      t.classList.add('active','border-red-500','text-zinc-900','dark:text-white');
      t.classList.remove('border-transparent','text-zinc-500','dark:text-zinc-500');
    } else {
      t.classList.remove('active','border-red-500','text-zinc-900','dark:text-white');
      t.classList.add('border-transparent','text-zinc-500','dark:text-zinc-500');
    }
  });
  simulate();
}

// ‚îÄ‚îÄ SLIDER DISPLAY ‚îÄ‚îÄ
function updateSliderDisplays(v) {
  const fxEl = document.getElementById('val-fx');
  fxEl.textContent = (v.fx*100).toFixed(0)+'%';
  fxEl.className = `font-mono text-sm font-semibold ${v.fx>0.3?'text-red-500':v.fx>0.1?'text-amber-500':'text-emerald-600 dark:text-emerald-400'}`;

  const fuelEl = document.getElementById('val-fuel');
  fuelEl.textContent = (v.fuel*100).toFixed(0)+'%';
  fuelEl.className = `font-mono text-sm font-semibold ${v.fuel>0.7?'text-red-500':v.fuel>0.3?'text-amber-500':'text-amber-500'}`;

  document.getElementById('val-port').textContent = v.port+' days';
  document.getElementById('val-supplier').textContent = (v.supplier*100).toFixed(0)+'%';
}

function getValues() {
  return {
    fx: parseFloat(document.getElementById('sl-fx').value)/100,
    fuel: parseFloat(document.getElementById('sl-fuel').value)/100,
    port: parseFloat(document.getElementById('sl-port').value),
    supplier: parseFloat(document.getElementById('sl-supplier').value)/100,
  };
}

// ‚îÄ‚îÄ MAIN SIMULATE ‚îÄ‚îÄ
function simulate() {
  const v = getValues();
  updateSliderDisplays(v);
  const co = COMPANIES[currentCompany];

  const importBase    = co.baseCost * co.importRatio;
  const fuelBase      = co.baseCost * co.fuelRatio;
  const logBase       = co.baseCost * co.logisticsRatio;
  const otherBase     = co.baseCost * (1 - co.importRatio - co.fuelRatio - co.logisticsRatio);
  const containersPerYear = co.shipments * 3;

  const fxImpact       = importBase * v.fx;
  const fuelImpact     = (fuelBase + logBase * 0.4) * v.fuel;
  const portImpact     = containersPerYear * 950000 * v.port;
  const supplierImpact = importBase * v.supplier * 0.32;
  const totalExtra     = fxImpact + fuelImpact + portImpact + supplierImpact;
  const sev            = severityConfig(totalExtra / co.baseCost);

  // ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ
  document.getElementById('ih-company').textContent = co.name + ' ¬∑ ' + co.sector;
  animVal('ih-total', fmt(totalExtra), '');
  document.getElementById('ih-total').style.color = totalExtra===0 ? 'white' : sev.barColor;
  document.getElementById('ih-sub').textContent = totalExtra===0
    ? 'No disruption ‚Äî baseline normal operations'
    : `+${((totalExtra/co.baseCost)*100).toFixed(1)}% above baseline ¬∑ ${sev.label} disruption`;

  animVal('cell-fx', '+'+fmt(fxImpact));
  animVal('cell-fuel', '+'+fmt(fuelImpact));
  animVal('cell-port', '+'+fmt(portImpact));
  animVal('cell-supplier', '+'+fmt(supplierImpact));

  // Severity pill
  const navSev = document.getElementById('nav-severity');
  navSev.className = `text-[10px] font-mono font-semibold tracking-wider px-3 py-1.5 rounded-full border transition-all duration-300 ${sev.tw}`;
  navSev.textContent = '‚óè '+sev.label;

  // Severity bar
  const bar = document.getElementById('severity-bar');
  bar.style.width = sev.barW;
  bar.style.background = sev.barColor;

  document.getElementById('rate-label').textContent =
    `‚Ç¶1,590/$ ‚Üí ‚Ç¶${Math.round(1590*(1+v.fx)).toLocaleString()}/$`;

  // ‚îÄ‚îÄ COST ROWS ‚îÄ‚îÄ
  const rows = [
    {icon:'üåç', name:'Import / Raw Materials', note:`USD-denominated ¬∑ ${Math.round(co.importRatio*100)}% of base costs`,   base:importBase, extra:fxImpact,       accentClass:'text-red-500'},
    {icon:'‚õΩ', name:'Fuel & Energy',           note:`Diesel, industrial fuel ¬∑ ${Math.round(co.fuelRatio*100)}% of costs`,  base:fuelBase,   extra:fuelImpact,     accentClass:'text-amber-500'},
    {icon:'üöö', name:'Logistics & Transport',   note:'Last-mile, haulage, warehousing',                                      base:logBase,    extra:fuelImpact*.4,  accentClass:'text-amber-400'},
    {icon:'‚öì', name:'Port & Demurrage',         note:`${co.shipments} shipments/yr ¬∑ ${containersPerYear} containers`,      base:0,          extra:portImpact,     accentClass:'text-blue-500'},
    {icon:'üîó', name:'Emergency Sourcing',       note:'32% premium on replacement supplier orders',                           base:0,          extra:supplierImpact, accentClass:'text-emerald-500'},
    {icon:'üìä', name:'Other Operating Costs',    note:'Overhead, admin, non-import',                                         base:otherBase,  extra:0,              accentClass:'text-zinc-400'},
  ];

  document.getElementById('cost-rows').innerHTML = rows.map(r => {
    const newVal = r.base + r.extra;
    const pct    = r.extra>0 ? '+'+((r.extra/co.baseCost)*100).toFixed(1)+'%' : '‚Äî';
    const progW  = Math.min((newVal/co.baseCost)*120, 100);
    return `
    <div class="flex items-center justify-between gap-4 px-6 py-4 hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors">
      <div class="flex items-start gap-3 flex-1 min-w-0">
        <span class="text-xl mt-0.5 flex-shrink-0">${r.icon}</span>
        <div class="min-w-0">
          <div class="text-sm font-semibold text-zinc-800 dark:text-zinc-200">${r.name}</div>
          <div class="text-[10px] font-mono text-zinc-400 mt-0.5">${r.note}</div>
          <div class="mt-2 h-1.5 bg-zinc-100 dark:bg-zinc-800 rounded-full w-40 overflow-hidden">
            <div class="h-full rounded-full transition-all duration-500" style="width:${progW}%;background:${r.extra>0?sev.barColor:'#d4d4d8'}"></div>
          </div>
        </div>
      </div>
      <div class="text-right flex-shrink-0">
        ${r.base>0?`<div class="text-[11px] font-mono text-zinc-400 line-through">${fmt(r.base)}</div>`:''}
        <div class="font-mono text-sm font-semibold ${r.extra>0?r.accentClass:'text-zinc-500 dark:text-zinc-400'}">${fmt(newVal)}</div>
        <div class="text-[10px] font-mono font-bold ${r.extra>0?r.accentClass:'text-zinc-300 dark:text-zinc-600'} mt-0.5">${r.extra>0?'+'+fmt(r.extra):pct}</div>
      </div>
    </div>`;
  }).join('');

  // ‚îÄ‚îÄ BAR CHART ‚îÄ‚îÄ
  const dark = isDark();
  const gridColor = dark ? 'rgba(255,255,255,0.04)' : 'rgba(0,0,0,0.04)';
  const tickColor = dark ? '#52525b' : '#a1a1aa';

  const cats = ['Import\nCosts','Fuel &\nEnergy','Logistics','Port\nCharges','Emergency\nSourcing'];
  const baseB = [importBase/1e9, fuelBase/1e9, logBase/1e9, 0, 0];
  const addB  = [fxImpact/1e9,  fuelImpact/1e9, fuelImpact*.4/1e9, portImpact/1e9, supplierImpact/1e9];

  if(barChart) barChart.destroy();
  barChart = new Chart(document.getElementById('barChart'), {
    type:'bar',
    data:{
      labels:cats,
      datasets:[
        {label:'Baseline',         data:baseB, backgroundColor: dark?'rgba(255,255,255,0.06)':'rgba(0,0,0,0.06)', borderRadius:4, borderSkipped:false},
        {label:'Additional Cost',  data:addB,  backgroundColor: sev.barColor+'cc', borderRadius:4, borderSkipped:false},
      ]
    },
    options:{responsive:true,maintainAspectRatio:false,
      plugins:{legend:{labels:{color:tickColor,boxWidth:8,font:{size:9,family:'JetBrains Mono'},padding:12}},
        tooltip:{backgroundColor:dark?'#18181b':'#fff',borderColor:dark?'#3f3f46':'#e4e4e7',borderWidth:1,titleColor:dark?'#f4f4f5':'#18181b',bodyColor:tickColor,callbacks:{label:c=>' ‚Ç¶'+c.raw.toFixed(2)+'B'}}},
      scales:{
        x:{grid:{display:false},ticks:{color:tickColor,font:{size:8,family:'JetBrains Mono'}}},
        y:{grid:{color:gridColor},ticks:{color:tickColor,font:{size:9,family:'JetBrains Mono'},callback:v=>'‚Ç¶'+v+'B'}}
      }
    }
  });

  // ‚îÄ‚îÄ FX CURVE ‚îÄ‚îÄ
  const fxRates = [0,10,20,30,40,50,60,70,80];
  const fxTotals = fxRates.map(pct => {
    const fi = importBase*(pct/100);
    return (co.baseCost + fi + fuelImpact + portImpact + supplierImpact)/1e9;
  });
  const currentFxPct = Math.round(v.fx*100);

  if(fxChart) fxChart.destroy();
  const fxCtx = document.getElementById('fxCurve').getContext('2d');
  const grad = fxCtx.createLinearGradient(0,0,0,160);
  grad.addColorStop(0, sev.barColor+'22'); grad.addColorStop(1, sev.barColor+'00');
  fxChart = new Chart(fxCtx, {
    type:'line',
    data:{
      labels:fxRates.map(r=>'+'+r+'%'),
      datasets:[{
        data:fxTotals, borderColor:sev.barColor, backgroundColor:grad, fill:true, tension:.4, borderWidth:2.5,
        pointRadius:fxRates.map(r=>r===currentFxPct?8:3),
        pointBackgroundColor:fxRates.map(r=>r===currentFxPct?'#f59e0b':sev.barColor),
        pointBorderColor:'#fff', pointBorderWidth:2,
      }]
    },
    options:{responsive:true,maintainAspectRatio:false,
      plugins:{legend:{display:false},
        tooltip:{backgroundColor:dark?'#18181b':'#fff',borderColor:dark?'#3f3f46':'#e4e4e7',borderWidth:1,titleColor:dark?'#f4f4f5':'#18181b',bodyColor:tickColor,
          callbacks:{
            title:c=>'Naira devalues by '+c[0].label,
            label:c=>' Total: ‚Ç¶'+c.raw.toFixed(1)+'B/yr',
            afterLabel:c=>fxRates[c.dataIndex]===currentFxPct?' ‚Üê Current simulation':''
          }}},
      scales:{
        x:{grid:{display:false},ticks:{color:tickColor,font:{size:9,family:'JetBrains Mono'}},title:{display:true,text:'Naira Devaluation %',color:tickColor,font:{size:9}}},
        y:{grid:{color:gridColor},ticks:{color:tickColor,font:{size:9,family:'JetBrains Mono'},callback:v=>'‚Ç¶'+v.toFixed(0)+'B'},title:{display:true,text:'Annual Cost (‚Ç¶B)',color:tickColor,font:{size:9}}}
      }
    }
  });

  // ‚îÄ‚îÄ RECOMMENDATIONS ‚îÄ‚îÄ
  const recs = [];
  const sevPct = totalExtra / co.baseCost;
  if(v.fx>.3) recs.push({type:'red',  title:'üö® Critical FX Exposure', body:`At ${(v.fx*100).toFixed(0)}% devaluation, ${co.name}'s import costs rise by ${fmt(fxImpact)} annually. Open domiciliary accounts immediately, pre-purchase USD for Q3/Q4 POs, and renegotiate supplier contracts to Naira-denominated pricing where possible.`});
  else if(v.fx>.1) recs.push({type:'amber', title:'‚ö†Ô∏è FX Risk Building', body:`A ${(v.fx*100).toFixed(0)}% devaluation adds ${fmt(fxImpact)} to import costs. Hedge at least 40% of anticipated USD requirements for the next 6 months.`});
  else recs.push({type:'green', title:'‚úÖ FX Exposure Manageable', body:`Current devaluation adds ${fmt(fxImpact)} ‚Äî within acceptable budget variance. Maintain quarterly FX exposure review.`});

  if(v.fuel>.5) recs.push({type:'red',   title:'üö® Fuel Cost Crisis',    body:`${(v.fuel*100).toFixed(0)}% fuel increase = ${fmt(fuelImpact)} extra annually. Invest in CNG fleet conversion, bulk diesel storage, and renegotiate logistics contracts with fuel escalation clauses.`});
  else if(v.fuel>.2) recs.push({type:'amber', title:'‚õΩ Fuel Costs Rising', body:`${(v.fuel*100).toFixed(0)}% increase = ${fmt(fuelImpact)} extra. Consolidate delivery runs, optimize routing, and pilot CNG or electric fleet segments.`});

  if(v.port>20) recs.push({type:'red',   title:'‚öì Port Congestion Crisis', body:`${v.port} extra days adds ${fmt(portImpact)} in demurrage. Divert shipments to Onne Port (Port Harcourt) or Calabar immediately. Pre-file customs documents 7 days before vessel arrival.`});
  else if(v.port>5) recs.push({type:'amber', title:'‚öì Port Delays Costing Money', body:`${v.port} extra days = ${fmt(portImpact)} in charges. Pre-register goods, use customs fast-track lanes, and maintain 45-day buffer stock.`});

  if(v.supplier>.2) recs.push({type:'red',  title:'üîó Supplier Base at Risk', body:`${(v.supplier*100).toFixed(0)}% failure rate forces ${fmt(supplierImpact)} in emergency sourcing premiums. Activate secondary supplier list and maintain minimum 2 qualified alternatives per critical input category.`});
  else if(v.supplier>0) recs.push({type:'zinc', title:'üîó Supplier Diversification Needed', body:`${(v.supplier*100).toFixed(0)}% failure = ${fmt(supplierImpact)} in emergency costs. Build approved vendor list of 3+ suppliers per category.`});

  const colorMap = {red:'border-red-500 bg-red-50 dark:bg-red-950/30',amber:'border-amber-500 bg-amber-50 dark:bg-amber-950/30',green:'border-emerald-500 bg-emerald-50 dark:bg-emerald-950/30',zinc:'border-blue-400 bg-blue-50 dark:bg-blue-950/30'};
  const titleMap = {red:'text-red-700 dark:text-red-400',amber:'text-amber-700 dark:text-amber-400',green:'text-emerald-700 dark:text-emerald-400',zinc:'text-blue-700 dark:text-blue-400'};
  document.getElementById('recommendations').innerHTML = recs.map(r=>`
    <div class="border-l-4 rounded-r-xl p-4 ${colorMap[r.type]}">
      <div class="text-sm font-semibold mb-1 ${titleMap[r.type]}">${r.title}</div>
      <div class="text-xs text-zinc-600 dark:text-zinc-400 leading-relaxed">${r.body}</div>
    </div>`).join('');

  // ‚îÄ‚îÄ SCENARIO TABLE ‚îÄ‚îÄ
  const scenarios = [
    {name:'Baseline (2022)',     fx:0,  fuel:0,   port:0,  supplier:0},
    {name:'2023 Mild Shock',     fx:15, fuel:20,  port:5,  supplier:5},
    {name:'2024 Reality',        fx:35, fuel:60,  port:15, supplier:10},
    {name:'Severe Disruption',   fx:50, fuel:100, port:30, supplier:20},
    {name:'Full Crisis',         fx:80, fuel:150, port:60, supplier:50},
    {name:'‚Ü≥ Your Simulation',   fx:Math.round(v.fx*100), fuel:Math.round(v.fuel*100), port:v.port, supplier:Math.round(v.supplier*100)},
  ];

  document.getElementById('scenario-tbody').innerHTML = scenarios.map((s,i)=>{
    const imp2 = importBase*(s.fx/100);
    const fue2 = (fuelBase+logBase*.4)*(s.fuel/100);
    const por2 = containersPerYear*950000*s.port;
    const sup2 = importBase*(s.supplier/100)*0.32;
    const tot  = imp2+fue2+por2+sup2;
    const sv   = severityConfig(tot/co.baseCost);
    const isActive = i===5;
    return `<tr class="${isActive?'bg-zinc-50 dark:bg-zinc-800/40 font-semibold':'hover:bg-zinc-50 dark:hover:bg-zinc-800/20'} transition-colors">
      <td class="px-4 py-3 text-sm ${isActive?'font-bold text-zinc-900 dark:text-zinc-100':'text-zinc-700 dark:text-zinc-300'}">${s.name}</td>
      <td class="px-4 py-3 font-mono text-xs text-zinc-600 dark:text-zinc-400">‚Ç¶${Math.round(1590*(1+s.fx/100)).toLocaleString()}/$</td>
      <td class="px-4 py-3 font-mono text-xs ${s.fuel>50?'text-red-500':'text-zinc-500'}">+${s.fuel}%</td>
      <td class="px-4 py-3 font-mono text-xs text-zinc-500">${s.port}d</td>
      <td class="px-4 py-3 font-mono text-xs text-zinc-500">${s.supplier}%</td>
      <td class="px-4 py-3 font-mono text-sm font-bold" style="color:${sv.barColor}">${fmt(tot)} <span class="font-normal text-[10px] text-zinc-400">(+${(tot/co.baseCost*100).toFixed(1)}%)</span></td>
      <td class="px-4 py-3"><span class="text-[9px] font-mono font-bold px-2 py-1 rounded-full border ${sv.tw}">${sv.label}</span></td>
    </tr>`;
  }).join('');
}

function animVal(id, text) {
  const el = document.getElementById(id);
  el.textContent = text;
  el.style.animation = 'none';
  void el.offsetWidth;
  el.style.animation = 'flash .25s ease';
}

function loadScenario(name) {
  const s = {mild:{fx:15,fuel:20,port:5,supplier:5},moderate:{fx:35,fuel:60,port:15,supplier:10},severe:{fx:50,fuel:100,port:30,supplier:20},crisis:{fx:80,fuel:150,port:60,supplier:50}}[name];
  document.getElementById('sl-fx').value       = s.fx;
  document.getElementById('sl-fuel').value     = s.fuel;
  document.getElementById('sl-port').value     = s.port;
  document.getElementById('sl-supplier').value = s.supplier;
  simulate();
}

function resetAll() {
  ['sl-fx','sl-fuel','sl-port','sl-supplier'].forEach(id => document.getElementById(id).value = 0);
  simulate();
}

// Re-render charts when OS dark mode changes
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', simulate);

// Init
renderTabs();
simulate();
</script>
</body>
</html>
